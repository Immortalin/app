// Generated by CoffeeScript 1.10.0
Ext.define('Ux.field.SelectOtherField', {
  extend: 'Ext.field.Select',
  xtype: 'selectotherfield',
  config: {
    otherText: 'Other...',
    promptTitle: 'New Option',
    promptMessage: 'Enter new option:'
  },
  addOtherField: function() {
    var i, opts;
    opts = this.getOptions();
    i = 0;
    while (i < opts.length) {
      if (opts[i].value === this.getOtherText()) {
        return;
      }
      i++;
    }
    opts.push({
      text: this.getOtherText(),
      value: this.getOtherText()
    });
    return this.updateOptions(opts);
  },
  fieldChange: function(cmp, newValue) {
    if (newValue === this.getOtherText()) {
      return Ext.Msg.prompt(this.getPromptTitle(), this.getPromptMessage(), (function(_this) {
        return function(choice, text) {
          if (choice === 'ok' && text.trim() !== '') {
            _this.insertOption(text);
          }
          if (choice === 'cancel') {
            return _this.setValue('');
          }
        };
      })(this));
    }
  },
  insertOption: function(text) {
    return util.ctl("Vehicles").updateVehicleList(this._name, text);
  }
});
